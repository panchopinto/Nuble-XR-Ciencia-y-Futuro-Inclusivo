<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Acciones</title>
  <script src="auth.js"></script>
  <style>
    body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;background:#0a1020;color:#eaf2ff}
    .wrap{max-width:900px;margin:0 auto;padding:20px}
    h1{margin:10px 0 14px}
    .panel{background:#101a34;border:1px solid #223054;border-radius:12px;padding:14px}
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    button{background:linear-gradient(135deg,#6EE7F9,#A78BFA);color:#0a1020;border:0;border-radius:10px;padding:10px 14px;font-weight:800;cursor:pointer}
    .muted{color:#a9b4d0}
  
  <style>
    /* admin-fab */
    .adminFab{position:fixed;right:14px;bottom:14px;display:none;z-index:9998;
      background:#101a34;border:1px solid #223054;border-radius:14px;box-shadow:0 10px 30px #000a;
      padding:8px;gap:8px;align-items:center}
    .adminFab button{background:linear-gradient(135deg,#6EE7F9,#A78BFA);color:#0a1020;border:0;border-radius:10px;padding:8px 10px;font-weight:800;cursor:pointer}
    .adminFab .email{font-size:12px;color:#cfe0ff;margin-right:6px}
  </style>

</style>
</head>
<body>
  <div class="wrap">
    <h1>Panel de acciones (admin)</h1>
    <div class="panel">
      <div>Estado: <span id="authEmail" class="muted">Cargando‚Ä¶</span></div>
      <div class="row">
        <button id="btnProtectOn">Activar modo protegido</button>
        <button id="btnProtectOff">Desactivar modo protegido</button>
        <button id="btnLogout">Cerrar sesi√≥n</button>
      </div>
      <p class="muted" style="margin-top:8px">El modo protegido bloquea click derecho, F12, Ctrl+U/C/S y difumina la UI.</p>
    </div>
  </div>
  <script>
  document.addEventListener('DOMContentLoaded', ()=>{
    const email = (localStorage.getItem('nxr_email')||'').toLowerCase();
    const authed = localStorage.getItem('nxr_auth')==='1';
    const allowed = (window.NXR_CONFIG && Array.isArray(NXR_CONFIG.allowedEmails)) ? NXR_CONFIG.allowedEmails.map(e=>e.toLowerCase()) : [];
    const ok = authed && email && allowed.includes(email);
    const label = document.getElementById('authEmail');
    label.textContent = ok ? (email + ' (autorizado)') : (authed ? (email || 'sin correo') + ' (no autorizado)' : 'No autenticado');
    document.getElementById('btnProtectOn').onclick = ()=>{ localStorage.setItem('nxr_protect','1'); alert('Modo protegido ACTIVADO'); };
    document.getElementById('btnProtectOff').onclick = ()=>{ localStorage.removeItem('nxr_protect'); alert('Modo protegido DESACTIVADO'); };
    document.getElementById('btnLogout').onclick = ()=>{ localStorage.removeItem('nxr_auth'); localStorage.removeItem('nxr_email'); location.href='index.html'; };
  });
  </script>

  <div class="adminFab" id="adminFab">
    <span class="email" id="fabEmail"></span>
    <button id="fabProtect">üõ°Ô∏è Protegido</button>
    <button onclick="location.href='acciones.html'">‚öôÔ∏è Acciones</button>
    <button id="fabLogout">üö™ Salir</button>
  </div>
  <script>
  (function(){
    function reveal(){
      try{
        const authed = localStorage.getItem('nxr_auth')==='1';
        const email = (localStorage.getItem('nxr_email')||'').toLowerCase();
        const allowed = (window.NXR_CONFIG && Array.isArray(NXR_CONFIG.allowedEmails)) ? NXR_CONFIG.allowedEmails.map(e=>e.toLowerCase()) : [];
        const ok = authed && email && allowed.includes(email);
        const fab = document.getElementById('adminFab');
        const lab = document.getElementById('fabEmail');
        if(!fab) return;
        if(ok){
          fab.style.display='flex';
          if(lab) lab.textContent = email;
        }else{
          fab.style.display='none';
        }
      }catch(e){}
    }
    function syncProtectLabel(){
      const on = localStorage.getItem('nxr_protect')==='1';
      const btn = document.getElementById('fabProtect');
      if(btn) btn.textContent = on ? 'üõ°Ô∏è Protegido ON' : 'üõ°Ô∏è Protegido OFF';
      if(on){ document.body.classList.add('protected'); } else { document.body.classList.remove('protected'); }
    }
    document.addEventListener('DOMContentLoaded', ()=>{
      reveal(); syncProtectLabel();
      const p = document.getElementById('fabProtect');
      const l = document.getElementById('fabLogout');
      if(p) p.onclick = ()=>{ if(localStorage.getItem('nxr_protect')==='1'){ localStorage.removeItem('nxr_protect'); } else { localStorage.setItem('nxr_protect','1'); } syncProtectLabel(); };
      if(l) l.onclick = ()=>{ localStorage.removeItem('nxr_auth'); localStorage.removeItem('nxr_email'); location.href='index.html'; };
    });
  })();
  </script>


<script>
document.addEventListener('contextmenu', function(e){ if(document.body.classList.contains('protected')) e.preventDefault(); }, true);
document.addEventListener('keydown', function(e){
  if(!document.body.classList.contains('protected')) return;
  if ((e.ctrlKey && (e.key==='u'||e.key==='U'||e.key==='s'||e.key==='S'||e.key==='c'||e.key==='C'))
       || e.key==='F12' || (e.ctrlKey && e.shiftKey && (e.key==='I'||e.key==='i'||e.key==='J'||e.key==='j'))) {
    e.preventDefault(); e.stopPropagation(); alert('Acci√≥n deshabilitada en modo presentaci√≥n.'); return false;
  }
}, true);
</script>
</body>
</html>
